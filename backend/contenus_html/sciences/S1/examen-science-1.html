<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Examen 1 – Sciences (Niveau 1)</title>
    <link
      rel="stylesheet"
      href="/contenus_css/sciences/S1/examen-science-1.css"
    />
  </head>
  <body>
    <header class="page-header">
      <h1>Examen 1 – Sciences (Niveau 1)</h1>
      <p class="subtitle">Le cycle de l’eau · Les 5 sens · Les plantes</p>
      <nav class="top-nav">
        <a href="/sciences/S1/le-cycle-de-leau.html"
          >Cours : Le cycle de l’eau</a
        >
        <a href="/sciences/S1/les-5-sens.html">Cours : Les 5 sens</a>
        <a href="/sciences/S1/les-plantes.html">Cours : Les plantes</a>
      </nav>
    </header>

    <!-- SCORE GLOBAL -->
    <section id="score-global" class="score-wrapper" aria-live="polite">
      <div class="score-card">
        <div>
          <div class="score-title">Score total</div>
          <div class="score-subtitle">Somme de toutes les parties</div>
        </div>
        <div class="score-right">
          <span id="score-value">0 / 0</span>
          <button id="btn-recalc" class="btn">Recalculer</button>
        </div>
      </div>
    </section>

    <main class="container">
      <!-- PARTIE A : CYCLE DE L'EAU -->
      <section class="exam-section" id="partie-cycle">
        <h2>Partie A — Le cycle de l’eau</h2>

        <!-- A1: Ordonner les étapes -->
        <div class="exercise" data-section="cycle-ordre">
          <h3>
            A1. Replace les étapes du cycle de l’eau dans le bon ordre (de 1 à
            5)
          </h3>
          <ol class="sortable" id="ordre-cycle">
            <!-- data-order indique l'ordre correct -->
            <li class="sortable-item" data-order="1">
              <span class="badge">—</span> Évaporation (et transpiration des
              plantes)
              <div class="move-btns">
                <button class="mini up">▲</button>
                <button class="mini down">▼</button>
              </div>
            </li>
            <li class="sortable-item" data-order="2">
              <span class="badge">—</span> Condensation (formation des nuages)
              <div class="move-btns">
                <button class="mini up">▲</button>
                <button class="mini down">▼</button>
              </div>
            </li>
            <li class="sortable-item" data-order="3">
              <span class="badge">—</span> Précipitations (pluie, neige, grêle)
              <div class="move-btns">
                <button class="mini up">▲</button>
                <button class="mini down">▼</button>
              </div>
            </li>
            <li class="sortable-item" data-order="4">
              <span class="badge">—</span> Infiltration et ruissellement
              <div class="move-btns">
                <button class="mini up">▲</button>
                <button class="mini down">▼</button>
              </div>
            </li>
            <li class="sortable-item" data-order="5">
              <span class="badge">—</span> Retour vers les cours d’eau et
              l’océan
              <div class="move-btns">
                <button class="mini up">▲</button>
                <button class="mini down">▼</button>
              </div>
            </li>
          </ol>

          <div class="btn-row">
            <button class="btn verifier">Vérifier</button>
            <button class="btn btn-secondary montrer">Voir l’ordre</button>
            <button class="btn btn-ghost reinitialiser">Réinitialiser</button>
          </div>
          <div class="resultat"></div>
        </div>

        <!-- A2: QCM -->
        <div class="exercise" data-section="cycle-qcm">
          <h3>A2. QCM (une seule bonne réponse par question)</h3>
          <ol class="qcm">
            <li>
              Quel processus transforme l’eau liquide en vapeur ?
              <div class="qcm-group" data-answer="evaporation">
                <label
                  ><input type="radio" name="q1" value="evaporation" />
                  L’évaporation</label
                >
                <label
                  ><input type="radio" name="q1" value="condensation" /> La
                  condensation</label
                >
                <label
                  ><input type="radio" name="q1" value="infiltration" />
                  L’infiltration</label
                >
                <label
                  ><input type="radio" name="q1" value="ruissellement" /> Le
                  ruissellement</label
                >
              </div>
            </li>
            <li>
              Quand la vapeur se refroidit et forme des nuages, c’est…
              <div class="qcm-group" data-answer="condensation">
                <label
                  ><input type="radio" name="q2" value="evaporation" />
                  L’évaporation</label
                >
                <label
                  ><input type="radio" name="q2" value="condensation" /> La
                  condensation</label
                >
                <label
                  ><input type="radio" name="q2" value="precipitations" /> Les
                  précipitations</label
                >
                <label
                  ><input type="radio" name="q2" value="transpiration" /> La
                  transpiration</label
                >
              </div>
            </li>
            <li>
              La principale source d’énergie du cycle de l’eau est…
              <div class="qcm-group" data-answer="soleil">
                <label
                  ><input type="radio" name="q3" value="soleil" /> Le
                  soleil</label
                >
                <label
                  ><input type="radio" name="q3" value="vent" /> Le vent</label
                >
                <label
                  ><input type="radio" name="q3" value="lune" /> La lune</label
                >
                <label
                  ><input type="radio" name="q3" value="marées" /> Les
                  marées</label
                >
              </div>
            </li>
            <li>
              Quand l’eau pénètre dans le sol, on parle d’…
              <div class="qcm-group" data-answer="infiltration">
                <label
                  ><input type="radio" name="q4" value="ruissellement" />
                  Ruissellement</label
                >
                <label
                  ><input type="radio" name="q4" value="infiltration" />
                  Infiltration</label
                >
                <label
                  ><input type="radio" name="q4" value="condensation" />
                  Condensation</label
                >
                <label
                  ><input type="radio" name="q4" value="evaporation" />
                  Évaporation</label
                >
              </div>
            </li>
          </ol>

          <div class="btn-row">
            <button class="btn verifier">Vérifier</button>
            <button class="btn btn-secondary montrer">Voir les réponses</button>
            <button class="btn btn-ghost reinitialiser">Réinitialiser</button>
          </div>
          <div class="resultat"></div>
        </div>
      </section>

      <!-- PARTIE B : LES 5 SENS -->
      <section class="exam-section" id="partie-sens">
        <h2>Partie B — Les 5 sens</h2>

        <!-- B1: Associer sens ↔ organe -->
        <div class="exercise" data-section="sens-organe">
          <h3>B1. Associe chaque sens à l’organe correspondant</h3>
          <table class="assoc">
            <tr>
              <th>Sens</th>
              <th>Organe</th>
            </tr>
            <tr>
              <td>La vue</td>
              <td>
                <select data-answer="yeux">
                  <option value="">— Choisir —</option>
                  <option value="yeux">Les yeux</option>
                  <option value="oreilles">Les oreilles</option>
                  <option value="nez">Le nez</option>
                  <option value="langue">La langue</option>
                  <option value="peau">La peau</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>L’ouïe</td>
              <td>
                <select data-answer="oreilles">
                  <option value="">— Choisir —</option>
                  <option value="yeux">Les yeux</option>
                  <option value="oreilles">Les oreilles</option>
                  <option value="nez">Le nez</option>
                  <option value="langue">La langue</option>
                  <option value="peau">La peau</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>L’odorat</td>
              <td>
                <select data-answer="nez">
                  <option value="">— Choisir —</option>
                  <option value="yeux">Les yeux</option>
                  <option value="oreilles">Les oreilles</option>
                  <option value="nez">Le nez</option>
                  <option value="langue">La langue</option>
                  <option value="peau">La peau</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Le goût</td>
              <td>
                <select data-answer="langue">
                  <option value="">— Choisir —</option>
                  <option value="yeux">Les yeux</option>
                  <option value="oreilles">Les oreilles</option>
                  <option value="nez">Le nez</option>
                  <option value="langue">La langue</option>
                  <option value="peau">La peau</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Le toucher</td>
              <td>
                <select data-answer="peau">
                  <option value="">— Choisir —</option>
                  <option value="yeux">Les yeux</option>
                  <option value="oreilles">Les oreilles</option>
                  <option value="nez">Le nez</option>
                  <option value="langue">La langue</option>
                  <option value="peau">La peau</option>
                </select>
              </td>
            </tr>
          </table>

          <div class="btn-row">
            <button class="btn verifier">Vérifier</button>
            <button class="btn btn-secondary montrer">Voir les réponses</button>
            <button class="btn btn-ghost reinitialiser">Réinitialiser</button>
          </div>
          <div class="resultat"></div>
        </div>

        <!-- B2: Quel sens pour… -->
        <div class="exercise" data-section="sens-sit">
          <h3>B2. Quel sens utilises-tu surtout pour… ?</h3>
          <ol class="grid-2">
            <li>
              Écouter de la musique
              <select data-answer-text="ouie">
                <option value="">— Choisir —</option>
                <option>vue</option>
                <option>ouïe</option>
                <option>odorat</option>
                <option>goût</option>
                <option>toucher</option>
              </select>
            </li>
            <li>
              Regarder un arc-en-ciel
              <select data-answer-text="vue">
                <option value="">— Choisir —</option>
                <option>vue</option>
                <option>ouïe</option>
                <option>odorat</option>
                <option>goût</option>
                <option>toucher</option>
              </select>
            </li>
            <li>
              Sentir des fleurs
              <select data-answer-text="odorat">
                <option value="">— Choisir —</option>
                <option>vue</option>
                <option>ouïe</option>
                <option>odorat</option>
                <option>goût</option>
                <option>toucher</option>
              </select>
            </li>
            <li>
              Goûter un citron
              <select data-answer-text="gout">
                <option value="">— Choisir —</option>
                <option>vue</option>
                <option>ouïe</option>
                <option>odorat</option>
                <option>goût</option>
                <option>toucher</option>
              </select>
            </li>
            <li>
              Toucher du papier de verre
              <select data-answer-text="toucher">
                <option value="">— Choisir —</option>
                <option>vue</option>
                <option>ouïe</option>
                <option>odorat</option>
                <option>goût</option>
                <option>toucher</option>
              </select>
            </li>
          </ol>

          <div class="btn-row">
            <button class="btn verifier">Vérifier</button>
            <button class="btn btn-secondary montrer">Voir les réponses</button>
            <button class="btn btn-ghost reinitialiser">Réinitialiser</button>
          </div>
          <div class="resultat"></div>
        </div>
      </section>

      <!-- PARTIE C : LES PLANTES -->
      <section class="exam-section" id="partie-plantes">
        <h2>Partie C — Les plantes</h2>

        <!-- C1: Associer partie ↔ fonction -->
        <div class="exercise" data-section="plantes-fonctions">
          <h3>
            C1. Associe chaque partie de la plante à sa fonction principale
          </h3>
          <table class="assoc">
            <tr>
              <th>Partie</th>
              <th>Fonction</th>
            </tr>
            <tr>
              <td>Les racines</td>
              <td>
                <select data-answer-text="absorber l eau">
                  <option value="">— Choisir —</option>
                  <option>Absorber l’eau et les minéraux</option>
                  <option>Réaliser la photosynthèse</option>
                  <option>Attirer les pollinisateurs</option>
                  <option>Transporter la sève</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>La tige</td>
              <td>
                <select data-answer-text="transporter la seve">
                  <option value="">— Choisir —</option>
                  <option>Soutenir et transporter la sève</option>
                  <option>Produire des graines</option>
                  <option>Absorber l’eau</option>
                  <option>Protéger le bourgeon</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Les feuilles</td>
              <td>
                <select data-answer-text="photosynthese">
                  <option value="">— Choisir —</option>
                  <option>Réaliser la photosynthèse</option>
                  <option>Former le fruit</option>
                  <option>Stocker des réserves</option>
                  <option>Transporter la sève</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>La fleur</td>
              <td>
                <select data-answer-text="reproduction">
                  <option value="">— Choisir —</option>
                  <option>Reproduction et production de graines</option>
                  <option>Réaliser la respiration</option>
                  <option>Absorber l’eau</option>
                  <option>Tenir la plante au sol</option>
                </select>
              </td>
            </tr>
          </table>

          <div class="btn-row">
            <button class="btn verifier">Vérifier</button>
            <button class="btn btn-secondary montrer">Voir les réponses</button>
            <button class="btn btn-ghost reinitialiser">Réinitialiser</button>
          </div>
          <div class="resultat"></div>
        </div>

        <!-- C2: Vrai/Faux -->
        <div class="exercise" data-section="plantes-vf">
          <h3>C2. Vrai ou Faux</h3>
          <ul class="vf">
            <li>
              La photosynthèse produit de l’oxygène.
              <select data-answer="vrai">
                <option value="">—</option>
                <option value="vrai">Vrai</option>
                <option value="faux">Faux</option>
              </select>
            </li>
            <li>
              Les racines servent surtout à voir la lumière.
              <select data-answer="faux">
                <option value="">—</option>
                <option value="vrai">Vrai</option>
                <option value="faux">Faux</option>
              </select>
            </li>
            <li>
              La fleur est l’organe reproducteur des plantes à fleurs.
              <select data-answer="vrai">
                <option value="">—</option>
                <option value="vrai">Vrai</option>
                <option value="faux">Faux</option>
              </select>
            </li>
            <li>
              Les feuilles réalisent la photosynthèse grâce à la chlorophylle.
              <select data-answer="vrai">
                <option value="">—</option>
                <option value="vrai">Vrai</option>
                <option value="faux">Faux</option>
              </select>
            </li>
          </ul>

          <div class="btn-row">
            <button class="btn verifier">Vérifier</button>
            <button class="btn btn-secondary montrer">Voir les réponses</button>
            <button class="btn btn-ghost reinitialiser">Réinitialiser</button>
          </div>
          <div class="resultat"></div>
        </div>
      </section>
    </main>

    <footer class="page-footer">
      <p>© 2025 - Examen de sciences (Niveau 1)</p>
    </footer>

    <script>
      // ===== Helpers =====
      const DEFAULT_TOL = 1e-6;
      const stripAcc = (s) =>
        (s || "").normalize("NFD").replace(/[\u0300-\u036f]/g, "");
      const norm = (s) =>
        stripAcc(String(s).trim().toLowerCase().replace(/\s+/g, " "));
      const approxEqual = (a, b, tol = DEFAULT_TOL) => Math.abs(a - b) <= tol;

      function markEl(el, state) {
        el.classList.remove("correct", "incorrect", "empty");
        el.classList.add(state);
      }

      function updateBadgesOrder(list) {
        list.querySelectorAll(".sortable-item").forEach((li, idx) => {
          const badge = li.querySelector(".badge");
          if (badge) badge.textContent = idx + 1;
        });
      }

      // ===== Vérifs =====
      function verifyOrder(section) {
        const list = section.querySelector("#ordre-cycle");
        let ok = 0,
          tot = 0;
        const items = Array.from(list.querySelectorAll(".sortable-item"));
        items.forEach((li, idx) => {
          tot++;
          const should = Number(li.dataset.order);
          if (idx + 1 === should) {
            ok++;
            markEl(li, "correct");
          } else {
            markEl(li, "incorrect");
          }
        });
        const res = section.querySelector(".resultat");
        res.style.display = "block";
        res.textContent = `Score : ${ok}/${tot}`;
        res.className = "resultat " + (ok === tot ? "correct" : "incorrect");
        updateGlobalScore();
      }

      function showOrder(section) {
        const list = section.querySelector("#ordre-cycle");
        const items = Array.from(list.querySelectorAll(".sortable-item"));
        items.sort((a, b) => Number(a.dataset.order) - Number(b.dataset.order));
        items.forEach((el) => list.appendChild(el));
        updateBadgesOrder(list);
        items.forEach((li) => markEl(li, "correct"));
        const res = section.querySelector(".resultat");
        res.style.display = "block";
        res.textContent = "Voici l’ordre correct.";
        res.className = "resultat correct";
        updateGlobalScore();
      }

      function resetOrder(section) {
        const list = section.querySelector("#ordre-cycle");
        const items = Array.from(list.querySelectorAll(".sortable-item"));
        // simple shuffle
        for (let i = items.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [items[i], items[j]] = [items[j], items[i]];
        }
        items.forEach((el) => {
          el.classList.remove("correct", "incorrect", "empty");
          list.appendChild(el);
        });
        updateBadgesOrder(list);
        const res = section.querySelector(".resultat");
        res.style.display = "none";
        res.textContent = "";
        res.className = "resultat";
        updateGlobalScore();
      }

      function verifyQCM(section) {
        let ok = 0,
          tot = 0;
        section.querySelectorAll(".qcm-group").forEach((group) => {
          tot++;
          const ans = group.dataset.answer;
          const checked = group.querySelector("input[type=radio]:checked");
          if (!checked) {
            markEl(group, "empty");
            return;
          }
          if (checked.value === ans) {
            ok++;
            markEl(group, "correct");
          } else {
            markEl(group, "incorrect");
          }
        });
        const res = section.querySelector(".resultat");
        res.style.display = "block";
        res.textContent = `Score : ${ok}/${tot}`;
        res.className = "resultat " + (ok === tot ? "correct" : "incorrect");
        updateGlobalScore();
      }

      function showQCM(section) {
        section.querySelectorAll(".qcm-group").forEach((group) => {
          const val = group.dataset.answer;
          const input = group.querySelector(`input[value="${val}"]`);
          if (input) {
            input.checked = true;
          }
          markEl(group, "correct");
        });
        const res = section.querySelector(".resultat");
        res.style.display = "block";
        res.textContent = "Réponses affichées.";
        res.className = "resultat correct";
        updateGlobalScore();
      }

      function resetQCM(section) {
        section
          .querySelectorAll("input[type=radio]")
          .forEach((i) => (i.checked = false));
        section
          .querySelectorAll(".qcm-group")
          .forEach((g) => g.classList.remove("correct", "incorrect", "empty"));
        const res = section.querySelector(".resultat");
        res.style.display = "none";
        res.textContent = "";
        res.className = "resultat";
        updateGlobalScore();
      }

      function verifySelectAssoc(section) {
        let ok = 0,
          tot = 0;
        // exact value assoc (B1)
        section
          .querySelectorAll("table.assoc select[data-answer]")
          .forEach((sel) => {
            tot++;
            if (sel.value === "") {
              markEl(sel, "empty");
              return;
            }
            if (norm(sel.value) === norm(sel.dataset.answer)) {
              ok++;
              markEl(sel, "correct");
            } else {
              markEl(sel, "incorrect");
            }
          });
        // text-based assoc (B2, C1)
        section.querySelectorAll("select[data-answer-text]").forEach((sel) => {
          tot++;
          if (sel.value === "") {
            markEl(sel, "empty");
            return;
          }
          const chosen = norm(sel.value);
          const expected = norm(sel.dataset.answerText);
          // tolérances pour accents/variantes: ouïe/ouie, goût/gout
          const map = { ouïe: "ouie", goût: "gout" };
          const c2 = map[sel.value] ? norm(map[sel.value]) : chosen;
          if (chosen === expected || c2 === expected) {
            ok++;
            markEl(sel, "correct");
          } else {
            markEl(sel, "incorrect");
          }
        });

        // Vrai/Faux (C2)
        section.querySelectorAll("ul.vf select[data-answer]").forEach((sel) => {
          tot++;
          if (sel.value === "") {
            markEl(sel, "empty");
            return;
          }
          if (norm(sel.value) === norm(sel.dataset.answer)) {
            ok++;
            markEl(sel, "correct");
          } else {
            markEl(sel, "incorrect");
          }
        });

        const res = section.querySelector(".resultat");
        res.style.display = "block";
        res.textContent = `Score : ${ok}/${tot}`;
        res.className = "resultat " + (ok === tot ? "correct" : "incorrect");
        updateGlobalScore();
      }

      function showSelectAssoc(section) {
        // B1 exact
        section
          .querySelectorAll("table.assoc select[data-answer]")
          .forEach((sel) => {
            sel.value = sel.dataset.answer;
            markEl(sel, "correct");
          });
        // text-based
        section.querySelectorAll("select[data-answer-text]").forEach((sel) => {
          const expected = sel.dataset.answerText;
          // set to the option whose normalized text matches expected
          const opts = Array.from(sel.options);
          const found = opts.find(
            (o) => norm(o.textContent) === norm(expected)
          );
          if (found) sel.value = found.value || found.textContent;
          markEl(sel, "correct");
        });
        // V/F
        section.querySelectorAll("ul.vf select[data-answer]").forEach((sel) => {
          sel.value = sel.dataset.answer;
          markEl(sel, "correct");
        });

        const res = section.querySelector(".resultat");
        res.style.display = "block";
        res.textContent = "Réponses affichées.";
        res.className = "resultat correct";
        updateGlobalScore();
      }

      function resetSelectAssoc(section) {
        section.querySelectorAll("select").forEach((sel) => {
          sel.value = "";
          sel.classList.remove("correct", "incorrect", "empty");
        });
        const res = section.querySelector(".resultat");
        res.style.display = "none";
        res.textContent = "";
        res.className = "resultat";
        updateGlobalScore();
      }

      // ===== Global score =====
      function countAll() {
        let total = 0,
          ok = 0;
        // items from order
        document
          .querySelectorAll("#ordre-cycle .sortable-item")
          .forEach((li) => {
            total++;
            if (li.classList.contains("correct")) ok++;
          });
        // QCM groups
        document.querySelectorAll(".qcm-group").forEach((g) => {
          total++;
          if (g.classList.contains("correct")) ok++;
        });
        // selects / vf selects
        document
          .querySelectorAll(
            "select[data-answer], select[data-answer-text], ul.vf select[data-answer]"
          )
          .forEach((sel) => {
            total++;
            if (sel.classList.contains("correct")) ok++;
          });
        return { total, ok };
      }
      function updateGlobalScore() {
        const { total, ok } = countAll();
        const label = document.getElementById("score-value");
        label.textContent = `${ok} / ${total}`;
        label.style.background =
          ok === total ? "var(--ok-bg)" : "var(--hint-bg)";
      }

      // ===== Wiring =====
      // Move up/down for order list
      document.querySelectorAll("#ordre-cycle .mini.up").forEach((btn) => {
        btn.addEventListener("click", () => {
          const li = btn.closest(".sortable-item");
          const prev = li.previousElementSibling;
          if (prev) li.parentElement.insertBefore(li, prev);
          updateBadgesOrder(li.parentElement);
        });
      });
      document.querySelectorAll("#ordre-cycle .mini.down").forEach((btn) => {
        btn.addEventListener("click", () => {
          const li = btn.closest(".sortable-item");
          const next = li.nextElementSibling;
          if (next) li.parentElement.insertBefore(next, li);
          updateBadgesOrder(li.parentElement);
        });
      });
      updateBadgesOrder(document.getElementById("ordre-cycle"));

      // Buttons per exercise
      document.querySelectorAll(".exercise").forEach((sec) => {
        const id = sec.dataset.section || "";
        sec.querySelector(".verifier")?.addEventListener("click", () => {
          if (id === "cycle-ordre") verifyOrder(sec);
          else if (id === "cycle-qcm") verifyQCM(sec);
          else verifySelectAssoc(sec);
        });
        sec.querySelector(".montrer")?.addEventListener("click", () => {
          if (id === "cycle-ordre") showOrder(sec);
          else if (id === "cycle-qcm") showQCM(sec);
          else showSelectAssoc(sec);
        });
        sec.querySelector(".reinitialiser")?.addEventListener("click", () => {
          if (id === "cycle-ordre") resetOrder(sec);
          else if (id === "cycle-qcm") resetQCM(sec);
          else resetSelectAssoc(sec);
        });
      });

      document
        .getElementById("btn-recalc")
        ?.addEventListener("click", updateGlobalScore);
      document.addEventListener("change", (e) => {
        if (e.target.matches("input, select")) updateGlobalScore();
      });
      updateGlobalScore();
    </script>
  </body>
</html>
